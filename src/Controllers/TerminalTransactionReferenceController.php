<?php

declare(strict_types=1);

/*
 * Payrix
 *
 * This file was automatically generated by Worldpay.
 */

namespace PayrixLib\Controllers;

use Core\Request\Parameters\BodyParam;
use Core\Request\Parameters\HeaderParam;
use Core\Response\Types\ErrorType;
use CoreInterfaces\Core\Request\RequestMethod;
use PayrixLib\Exceptions\ApiException;
use PayrixLib\Exceptions\ErrorFourHundredException;
use PayrixLib\Models\TerminalTxnRefPostRequest;
use PayrixLib\Models\TerminalTxnRefResponseResult;

class TerminalTransactionReferenceController extends BaseController
{
    /**
     * Create a terminalTxnRefs resource, which represents a reference code issued by the Processor in
     * relation to a particular Transaction.
     *
     * @param TerminalTxnRefPostRequest $body Create Terminal Transaction Reference Request
     * @param string|null $token A single-use, limited authentication layer in addition to an API
     *        Key or Session Key to authorize sensitive operations. <a href="/apis/payrix/dev-int-
     *        guide/references/authentication/auth-tokens" target="_blank">Auth Tokens</a> add
     *        security by requiring one-time approval for specific actions.
     * @param string|null $requestToken A custom, one-time identifier for any API request (GET, PUT,
     *        POST, or DELETE). Blocks future requests with the same token for 48 hours, ensuring
     *        only the first request is processed. Valid values can contain 1-100 alphanumeric and
     *        special characters. See <a href="/apis/payrix/dev-int-
     *        guide/references/authentication/request-tokens" target="_blank">Request Tokens</a>
     *        for more information.
     *
     * @return TerminalTxnRefResponseResult Response from the API call
     *
     * @throws ApiException Thrown if API call fails
     */
    public function postTerminalTxnRefs(
        TerminalTxnRefPostRequest $body,
        ?string $token = null,
        ?string $requestToken = null
    ): TerminalTxnRefResponseResult {
        $_reqBuilder = $this->requestBuilder(RequestMethod::POST, '/terminalTxnRefs')
            ->auth('apiKey', 'sessionKey', 'txnSessionKey')
            ->parameters(
                HeaderParam::init('Content-Type', 'application/json'),
                BodyParam::init($body),
                HeaderParam::init('token', $token),
                HeaderParam::init('request-token', $requestToken)
            );

        $_resHandler = $this->responseHandler()
            ->throwErrorOn('400', ErrorType::init('Error', ErrorFourHundredException::class))
            ->type(TerminalTxnRefResponseResult::class);

        return $this->execute($_reqBuilder, $_resHandler);
    }
}
